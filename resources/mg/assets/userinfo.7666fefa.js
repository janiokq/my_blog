var v=Object.defineProperty;var w=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable;var g=(e,a,s)=>a in e?v(e,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[a]=s,y=(e,a)=>{for(var s in a||(a={}))C.call(a,s)&&g(e,s,a[s]);if(w)for(var s of w(a))b.call(a,s)&&g(e,s,a[s]);return e};import{g as B,B as E,R as A}from"./cos.1cd9f046.js";import{_,b as D,m as S,o as V}from"./index.dcbee9bf.js";import{h as k,k as m,a as N,S as P,t as I,x as p,y as K,D as R,G as c,B as o,A as i,R as U}from"./element-plus.935a2e22.js";const{updateUserInfo:L}=D(),M=k({name:"UserPage",methods:{async uploadChange(e){const a=e.currentTarget.files;let s="";const f=[...a].map(r=>{const t=r.webkitRelativePath||r.name;if(r.type.indexOf("image")!=-1?r.size>102400&&(s="\u4E0D\u80FD\u8D85\u8FC71MB"):s="\u4EC5\u652F\u6301\u4E0A\u4F20\u56FE\u7247\u6587\u4EF6",s!=""){m.warning({message:s,type:"warning"});return}let l=B();return{Bucket:E,Region:A,Key:l+t,Body:r}}),d=(await S()).data;d.code==0?new COS({SecretId:d.data.secret_id,SecretKey:d.data.secret_key}).uploadFiles({files:f,SliceSize:1024*1024*10,onProgress:function(t){var n=parseInt(String(t.percent*1e4))/100,l=parseInt(String(t.speed/1024/1024*100))/100;console.log("\u8FDB\u5EA6\uFF1A"+n+"%; \u901F\u5EA6\uFF1A"+l+"Mb/s;")},onFileFinish:function(t,n,l){console.log(l.Key+"\u4E0A\u4F20"+(t?"\u5931\u8D25":"\u5B8C\u6210"))}},(t,n)=>{if(t!=null||t!=null){console.log("\u4E0A\u4F20\u5931\u8D25",t);return}this.avatar="https://"+n.files[0].data.Location}):m.error("\u521D\u59CB\u5316\u4E0A\u4F20\u914D\u7F6E\u5931\u8D25")},uploadAvatar(){document.querySelectorAll(".file-select")[0].click()},async submitForm(){if(this.password!=""&&this.password!=this.rpassword){m.warning({message:"\u8BF7\u586B\u5199\u6B63\u786E\u7684\u5BC6\u7801",type:"warning"});return}await L({name:this.userName,password:this.password,avatar:this.avatar,phone:this.phone})}},props:{},data(){return{labelPosition:"right",userName:"",password:"",rpassword:"",avatar:"",phone:0}},setup:()=>{let e=N({userName:"",password:"",rpassword:"",avatar:"",phone:0});return P(async()=>{const a=await V("userinfo");e.userName=a.name,e.avatar=a.avatar,e.phone=a.phone}),y({},I(e))}}),$={style:{background:"white",padding:"15px"}},j={style:{width:"400px"}},z=U("\u63D0\u4EA4");function O(e,a,s,f,F,d){const r=p("el-avatar"),t=p("el-form-item"),n=p("el-input"),l=p("el-button"),h=p("el-form");return K(),R("div",$,[c("div",j,[o(h,{"label-position":e.labelPosition,"label-width":"80px"},{default:i(()=>[o(t,{label:"\u5934\u50CF"},{default:i(()=>[c("div",{style:{cursor:"pointer"},onClick:a[1]||(a[1]=(...u)=>e.uploadAvatar&&e.uploadAvatar(...u))},[o(r,{size:100,src:e.avatar},null,8,["src"]),c("input",{type:"file",style:{display:"none"},onChange:a[0]||(a[0]=(...u)=>e.uploadChange&&e.uploadChange(...u)),class:"file-select"},null,32)])]),_:1}),o(t,{label:"\u59D3\u540D"},{default:i(()=>[o(n,{modelValue:e.userName,"onUpdate:modelValue":a[2]||(a[2]=u=>e.userName=u)},null,8,["modelValue"])]),_:1}),o(t,{label:"\u5BC6\u7801"},{default:i(()=>[o(n,{type:"password",modelValue:e.password,"onUpdate:modelValue":a[3]||(a[3]=u=>e.password=u)},null,8,["modelValue"])]),_:1}),o(t,{label:"\u786E\u8BA4\u5BC6\u7801"},{default:i(()=>[o(n,{type:"password",modelValue:e.rpassword,"onUpdate:modelValue":a[4]||(a[4]=u=>e.rpassword=u)},null,8,["modelValue"])]),_:1}),o(t,null,{default:i(()=>[o(l,{type:"primary",onClick:e.submitForm},{default:i(()=>[z]),_:1},8,["onClick"])]),_:1})]),_:1},8,["label-position"])])])}var J=_(M,[["render",O]]);export{J as default};
