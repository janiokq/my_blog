var L=Object.defineProperty;var w=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var v=(e,t,a)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,y=(e,t)=>{for(var a in t||(t={}))F.call(t,a)&&v(e,a,t[a]);if(w)for(var a of w(t))B.call(t,a)&&v(e,a,t[a]);return e};import m from"./editor_article.cc295a17.js";import{_ as V,p as I,q as j,B as x,v as k}from"./index.dcbee9bf.js";import{O as M}from"./index.03757b96.js";import{h as O,k as g,a as T,S as U,t as R,x as l,y as c,D as d,G as r,B as s,A as n,W,Q as C,P as A,R as D,O as f,M as q,N as G}from"./element-plus.935a2e22.js";import"./cos.1cd9f046.js";const Q=O({name:"ArticlePage",props:{},components:{[m.name]:m,EditorPage:m,OpenWindow:M},methods:{async callme(e){if(this.drawer=!1,e!=null&&e!=""){if(e=="")this.loadData(!0);else{let t=-1,a=-1;if(state.articleList.forEach(o=>{t+=1,o._id.$oid==e&&(a=t)}),a!=-1){const u=(await I(u)).data;u.code==0?state.articleList[a]=u.data:g.error(u.msg)}else this.loadData(!0)}state.drawer=!1}},changePage(e){this.page=e-1,this.loadData(!1)},async delArticle(e){(await j(e._id.$oid)).data.code==0?this.articleList.splice(this.articleList.indexOf(e),1):g.error("\u5220\u9664\u5931\u8D25")},viewArticle(e){window.open(x+"article/"+e._id.$oid,"_blank")},editTheArticles(e){this.editid=e._id.$oid,this.drawer=!0},search(){this.page=0,this.loadData(!0)},async loadData(e){var o;e&&(this.page=0),this.pageSize,this.page,this.articleName!=null&&this.articleName!="";const a=(await k({page_size:this.pageSize,page:this.page,keyword:(o=this.articleName)!=null?o:""})).data;a.code==0?(this.allPage=Math.ceil(a.data.total/this.pageSize)-1,this.articleList=a.data.data,this.allPage<=this.page||this.page++):g.error("\u52A0\u8F7D\u5931\u8D25")},handleClose(e){this.$confirm("\u786E\u8BA4\u5173\u95ED\uFF1F").then(t=>{e()}).catch(t=>{})}},data(){return{page:0,allPage:0,pageSize:10,articleName:"",articleList:[],drawer:!1,editid:"0",direction:"btt",error:{}}},setup:()=>{let e=T({articleList:[],articleName:"",page:0,allPage:0,pageSize:10,drawer:!1,direction:"btt",editid:"0",error:{}}),t=async()=>{e.page=0;const o=(await k({page:e.page,page_size:e.pageSize,keyword:""})).data;o.code==0?(e.allPage=Math.ceil(o.data.total/e.pageSize)-1,e.articleList=o.data.data,e.allPage<=e.page||e.page++):g.error("\u52A0\u8F7D\u5931\u8D25")};return U(()=>{t()}),y({},R(e))}}),H=e=>(q("data-v-4f643946"),e=e(),G(),e),J={style:{padding:"15px",background:"white"}},K={style:{height:"50px","text-align":"left"}},X=D("\u641C\u7D22"),Y=D("\u521B\u5EFA"),Z={key:0,style:{height:"200px","line-height":"200px"}},ee={class:"actitem"},te=H(()=>r("div",{class:"image-slot"},[r("i",{class:"el-icon-picture-outline"})],-1)),ae={style:{flex:"1"}},ie=["onClick"],se={class:"actdec"},oe={class:"acttags"},le={class:"tagsitemSpan"};function ne(e,t,a,o,u,re){const b=l("el-input"),_=l("el-form-item"),h=l("el-button"),E=l("el-form"),P=l("el-image"),$=l("el-popconfirm"),z=l("el-pagination"),S=l("EditorPage"),N=l("open-window");return c(),d("div",J,[r("div",K,[s(E,{inline:!0,class:"demo-form-inline"},{default:n(()=>[s(_,null,{default:n(()=>[s(b,{modelValue:e.articleName,"onUpdate:modelValue":t[0]||(t[0]=i=>e.articleName=i),placeholder:"\u6587\u7AE0\u6807\u9898"},null,8,["modelValue"])]),_:1}),s(_,null,{default:n(()=>[s(h,{type:"primary",onClick:e.search},{default:n(()=>[X]),_:1},8,["onClick"])]),_:1}),s(_,null,{default:n(()=>[s(h,{type:"success",onClick:t[1]||(t[1]=i=>{e.editid="0",e.drawer=!0})},{default:n(()=>[Y]),_:1})]),_:1})]),_:1})]),e.articleList.length==0?(c(),d("div",Z,"\u6682\u65E0\u6570\u636E")):W("",!0),(c(!0),d(C,null,A(e.articleList,i=>(c(),d("div",{key:i},[r("div",ee,[s(P,{src:i.cover_pic,lazy:"",class:"actImage",onClick:p=>e.editTheArticles(i)},{error:n(()=>[te]),_:2},1032,["src","onClick"]),r("div",ae,[r("div",{class:"acttitle",onClick:p=>e.editTheArticles(i)},f(i.title),9,ie),r("div",se,f(i.describe),1),r("div",oe,[(c(!0),d(C,null,A(i.tags,p=>(c(),d("span",le,f(p.name),1))),256)),s(h,{icon:"el-icon-document-checked",circle:"",size:"mini",style:{"margin-left":"20px"},onClick:p=>e.viewArticle(i)},null,8,["onClick"]),s($,{"confirm-button-text":"\u5220\u9664","cancel-button-text":"\u53D6\u6D88",icon:"el-icon-info","icon-color":"red",title:"\u786E\u5B9A\u5220\u9664\u5F53\u524D\u6587\u7AE0",onConfirm:p=>e.delArticle(i)},{reference:n(()=>[s(h,{icon:"el-icon-delete",circle:"",size:"mini"})]),_:2},1032,["onConfirm"])])])])]))),128)),s(z,{style:{"text-align":"left"},background:"",layout:"prev, pager, next",total:(e.allPage+1)*10,onCurrentChange:e.changePage},null,8,["total","onCurrentChange"]),s(N,{show:e.drawer,"onUpdate:show":t[2]||(t[2]=i=>e.drawer=i),"is-show":e.drawer,title:"\u7F16\u8F91\u9875\u9762"},{default:n(()=>[s(S,{"article-i-d":e.editid,"call-back":e.callme},null,8,["article-i-d","call-back"])]),_:1},8,["show","is-show"])])}var _e=V(Q,[["render",ne],["__scopeId","data-v-4f643946"]]);export{_e as default};
